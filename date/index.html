<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <div class="date-container">
    <div class="date-box">
      <input type="text" id="date" class="input-date">
      <div class="date-content">
        <div class="date-header">
          <div class="date-icon-box">
            <span class="double-left"></span>
            <span class="single-left"></span>
          </div>
          <div class="date-year-month">
            <span class="year">2022 年</span>
            <span class="month">8 月</span>
          </div>
          <div class="date-icon-box">
            <span class="single-right"></span>
            <span class="double-right"></span>
          </div>
        </div>
        <div class="date-body">
          <table id="date-table">
            <thead>
              <tr>
                <th>日</th>
                <th>一</th>
                <th>二</th>
                <th>三</th>
                <th>四</th>
                <th>五</th>
                <th>六</th>
              </tr>
            </thead>
            <tbody id="date-body">

            </tbody>
          </table>
        </div>
        <div class="date-footer">
          <span>2022-10-02</span>
          <div class="button-box">
            <span>清空</span><span>现在</span><span>确定</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
<script>
  let date = getMonthFirstDay(new Date())
  let week = new Date(date).getDay()
  console.log(week)

  let currentYear = new Date(date).getFullYear()
  let currentMonth = new Date(date).getMonth() + 1
  let lastMonth = currentMonth == 1 ? 12 : currentMonth - 1
  let nextMonth = currentMonth == 12 ? 1 : currentMonth + 1

  let currentMonthDays = haoManyDays(currentYear, currentMonth)
  let lastMonthDays = haoManyDays(lastMonth == 12 ? currentYear - 1 : currentYear, lastMonth)
  let nextMonthDays = haoManyDays(nextMonth == 1 ? currentYear + 1 : currentYear, nextMonth)

  console.log('开始区间' + (lastMonthDays - week + 1) + '---' + lastMonthDays)
  console.log('中间区间' + 1 + '---' + currentMonthDays)
  console.log('结束区间' + 1 + '---' + (42 - currentMonthDays - week))
  let section1 = [...new Array(lastMonthDays + 1).keys()].slice(lastMonthDays - week + 1)
  let section2 = [...new Array(currentMonthDays + 1).keys()].slice(1)
  let section3 = [...new Array(42 - currentMonthDays - week + 1).keys()].slice(1)
  let allSection = [...section1, ...section2, ...section3]

  console.log('section1',section1)
  console.log('section2',section2)
  console.log('section3',section3)
  console.log('section3',allSection)
  createTable(allSection)

  function haoManyDays(year, month) {
    const table = {
      1: 31, 3: 31, 5: 31, 7: 31, 8: 31, 9: 30, 10: 31, 12: 31,
      4: 30, 6: 30, 9: 30, 11: 30,
      2: isLeapYear(year) ? 29 : 28
    }
    return table[month]
  }

  function isLeapYear(year) {
    if ((year % 4 == 0 && !(year % 100 == 0)) || year % 400 == 0) {
      return true
    } else {
      return false
    }
  }

  function createTable(arrs) {
    let  table = document.getElementById('date-table')
    let  body = document.getElementById('date-body')
    for (let i = 0; i <= 5; i++) {
      let tr = document.createElement('tr')
      for (let j = 0; j <= 6; j++) {
        let td = document.createElement('td')
        td.textContent = arrs[i*7+j]
        tr.appendChild(td)
      }
      body.appendChild(tr)
    }
  }

  function getMonthFirstDay(date){
    let currentYear = date.getFullYear()
    let currentMonth = date.getMonth() + 1
    console.log(`${currentYear}-${currentMonth}-1`)
    return new Date(`${currentYear}-${currentMonth}-1`)
  }



</script>
</html>